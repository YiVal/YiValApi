"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[552],{9415:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>u,frontMatter:()=>s,metadata:()=>a,toc:()=>l});var i=t(5893),r=t(1151);const s={sidebar_position:6},o="Selection",a={id:"API-Reference/selection",title:"Selection",description:"SelectionStrategy",source:"@site/docs/API-Reference/selection.md",sourceDirName:"API-Reference",slug:"/API-Reference/selection",permalink:"/YiValApi/docs/API-Reference/selection",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/API-Reference/selection.md",tags:[],version:"current",sidebarPosition:6,frontMatter:{sidebar_position:6},sidebar:"tutorialSidebar",previous:{title:"Wrapper",permalink:"/YiValApi/docs/API-Reference/wrapper"},next:{title:"State",permalink:"/YiValApi/docs/API-Reference/state"}},c={},l=[{value:"<code>SelectionStrategy</code>",id:"selectionstrategy",level:2},{value:"Introduction",id:"introduction",level:3},{value:"Class Definition",id:"class-definition",level:3},{value:"Description",id:"description",level:4},{value:"Attributes",id:"attributes",level:4},{value:"Example",id:"example",level:3},{value:"Source Code",id:"source-code",level:3},{value:"<code>AHPSelectionStrategy</code>",id:"ahpselectionstrategy",level:2},{value:"Introduction",id:"introduction-1",level:3},{value:"Class Definition",id:"class-definition-1",level:3},{value:"Description",id:"description-1",level:4},{value:"Attributes",id:"attributes-1",level:4},{value:"Example",id:"example-1",level:3},{value:"AHPSelection Configuration",id:"ahpselection-configuration",level:4},{value:"Use OpenAI Prompt Data Generator in the YiVal config",id:"use-openai-prompt-data-generator-in-the-yival-config",level:4},{value:"Custom Selection Strategy Guide:  <code>CustomSelectionStrategy</code>",id:"custom-selection-strategy-guide--customselectionstrategy",level:2},{value:"Introduction",id:"introduction-2",level:3},{value:"The Essence of Selection Strategy",id:"the-essence-of-selection-strategy",level:3},{value:"Crafting a Custom Selection Strategy",id:"crafting-a-custom-selection-strategy",level:3},{value:"Config",id:"config",level:3}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"selection",children:"Selection"}),"\n",(0,i.jsx)(n.h2,{id:"selectionstrategy",children:(0,i.jsx)(n.code,{children:"SelectionStrategy"})}),"\n",(0,i.jsx)(n.h3,{id:"introduction",children:"Introduction"}),"\n",(0,i.jsx)(n.p,{children:"This module defines an abstract base class for selection strategies. A selection strategy determines how to select or prioritize specific experiments, scenarios, or configurations based on certain criteria."}),"\n",(0,i.jsx)(n.h3,{id:"class-definition",children:"Class Definition"}),"\n",(0,i.jsx)(n.h4,{id:"description",children:"Description"}),"\n",(0,i.jsx)(n.h4,{id:"attributes",children:"Attributes"}),"\n",(0,i.jsx)(n.h3,{id:"example",children:"Example"}),"\n",(0,i.jsx)(n.h3,{id:"source-code",children:(0,i.jsx)(n.a,{href:"https://github.com/YiVal/YiVal/blob/master/src/yival/result_selectors/selection_strategy.py",children:"Source Code"})}),"\n",(0,i.jsx)(n.h2,{id:"ahpselectionstrategy",children:(0,i.jsx)(n.code,{children:"AHPSelectionStrategy"})}),"\n",(0,i.jsx)(n.h3,{id:"introduction-1",children:"Introduction"}),"\n",(0,i.jsxs)(n.p,{children:["This module provides the ",(0,i.jsx)(n.code,{children:"AHPSelection"})," class, which is a selection strategy based on the Analytic Hierarchy Process (AHP). The strategy uses the provided criteria, their weights, and data from the experiment to rank the experiment combinations and select the best one."]}),"\n",(0,i.jsx)(n.h3,{id:"class-definition-1",children:"Class Definition"}),"\n",(0,i.jsx)(n.h4,{id:"description-1",children:"Description"}),"\n",(0,i.jsx)(n.p,{children:"A data class defining the configuration for the AHPSelection strategy."}),"\n",(0,i.jsx)(n.h4,{id:"attributes-1",children:"Attributes"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"criteria(List[str])"})}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"A list of criteria names to be considered during selection."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"criteria_weights(Dict[str, float])"})}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"A dictionary mapping each criterion to its weight."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"criteria_maximization(Dict[str, bool])"})}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"A dictionary indicating whether each criterion should be maximized (True) or minimized (False)."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"normalize_func(Optional[str])"})}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"The name of the normalization function to be used, if any."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"example-1",children:"Example"}),"\n",(0,i.jsx)(n.h4,{id:"ahpselection-configuration",children:"AHPSelection Configuration"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-Python",children:'    combination_A = CombinationAggregatedMetrics(\r\n        combo_key=str({"name": "A"}),\r\n        experiment_results=[],\r\n        aggregated_metrics={},\r\n        average_token_usage=120,\r\n        average_latency=200,\r\n        combine_evaluator_outputs=[EvaluatorOutput(name="elo", result=1500)]\r\n    )\r\n\r\n    # Combination B has a lower elo, but also much lower token usage and\r\n    # latency\r\n    combination_B = CombinationAggregatedMetrics(\r\n        combo_key=str({"name": "B"}),\r\n        experiment_results=[],\r\n        aggregated_metrics={},\r\n        average_token_usage=50,\r\n        average_latency=50,\r\n        combine_evaluator_outputs=[EvaluatorOutput(name="elo", result=1300)]\r\n    )\r\n\r\n    #Combination C has highest elo with highest token usage and latency\r\n    combination_C = CombinationAggregatedMetrics(\r\n        combo_key=str({"name": "C"}),\r\n        experiment_results=[],\r\n        aggregated_metrics={},\r\n        average_token_usage=300,\r\n        average_latency=300,\r\n        combine_evaluator_outputs=[EvaluatorOutput(name="elo", result=1600)]\r\n    )\r\n\r\n    # The experiment data\r\n    trade_off_test_data = Experiment(\r\n        combination_aggregated_metrics=[\r\n            combination_A, combination_B, combination_C\r\n        ],\r\n        group_experiment_results=[]\r\n    )\r\n\r\n    config_trade_off = AHPConfig(\r\n        criteria=["elo", "average_token_usage", "average_latency"],\r\n        criteria_weights={\r\n            "elo": 0.6,\r\n            "average_token_usage": 0.2,\r\n            "average_latency": 0.2\r\n        },\r\n        criteria_maximization={\r\n            "elo": True,\r\n            "average_token_usage": False,\r\n            "average_latency": False\r\n        },\r\n        normalize_func=\'z-score\'\r\n    )\r\n    context_trade_off = SelectionContext(\r\n        strategy=AHPSelection(config=config_trade_off)\r\n    )\r\n    best_combo_trade_off = context_trade_off.execute_selection(\r\n        trade_off_test_data\r\n    )\r\n    print(best_combo_trade_off)\r\n   \n'})}),"\n",(0,i.jsx)(n.h4,{id:"use-openai-prompt-data-generator-in-the-yival-config",children:"Use OpenAI Prompt Data Generator in the YiVal config"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-YAML",children:'selection_strategy:\r\n  ahp_selection:\r\n    criteria:\r\n      - "openai_prompt_based_evaluator: clear"\r\n      - average_token_usage\r\n      - average_latency\r\n    criteria_maximization:\r\n      "openai_prompt_based_evaluator: clear": true\r\n      average_latency: false\r\n      average_token_usage: false\r\n    criteria_weights:\r\n      "openai_prompt_based_evaluator: clear": 0.6\r\n      average_latency: 0.2\r\n      average_token_usage: 0.2\r\n    normalize_func: "z-score"\n'})}),"\n",(0,i.jsxs)(n.h2,{id:"custom-selection-strategy-guide--customselectionstrategy",children:["Custom Selection Strategy Guide:  ",(0,i.jsx)(n.code,{children:"CustomSelectionStrategy"})]}),"\n",(0,i.jsx)(n.h3,{id:"introduction-2",children:"Introduction"}),"\n",(0,i.jsx)(n.p,{children:"Selection strategies are paramount in the experimental framework, guiding the selection or prioritization of experiments, scenarios, or configurations. These strategies can be based on a variety of criteria, ranging from past performance to specific business rules. In this guide, we'll outline the process for creating your own custom selection strategy."}),"\n",(0,i.jsx)(n.h3,{id:"the-essence-of-selection-strategy",children:"The Essence of Selection Strategy"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"SelectionStrategy"})," class is the backbone of all selection strategies. It encapsulates core methods to:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Register new selection strategies."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Retrieve registered strategies."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Access their default configurations."}),"\n",(0,i.jsx)(n.p,{children:"At its core, a selection strategy's primary task is to decide how to select or prioritize specific experiments or configurations."}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"crafting-a-custom-selection-strategy",children:"Crafting a Custom Selection Strategy"}),"\n",(0,i.jsxs)(n.p,{children:["To devise a custom selection strategy, you should inherit from the ",(0,i.jsx)(n.code,{children:"SelectionStrategy"})," class and implement the ",(0,i.jsx)(n.code,{children:"select"})," abstract method:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-Python",children:'class CustomSelectionStrategy(SelectionStrategy):\r\n    """\r\n    Custom strategy for selecting experiments.\r\n    """\r\n\r\n    def select(self, experiment):\r\n        """\r\n        Custom logic for selecting or prioritizing experiments.\r\n\r\n        Args:\r\n            experiment (Experiment): The experiment under consideration.\r\n\r\n        Returns:\r\n            SelectionOutput: The result of the selection process.\r\n        """\r\n\r\n        # Your selection logic goes here\r\n        pass\n'})}),"\n",(0,i.jsx)(n.h3,{id:"config",children:"Config"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-YAML",children:"custom_selection_strategies:\r\n  custom_selection_strategy:\r\n    class: /path/to/custom_selection_strategy.CustomSelectionStrategy\r\n    config_cls: /path/to/custom_selection_strategy.CustomSelectionStrategyConfig\n"})}),"\n",(0,i.jsx)(n.p,{children:"To use it:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-Plaintext",children:"selection_strategy:\r\n  custom_selection_strategies:\n"})})]})}function u(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},1151:(e,n,t)=>{t.d(n,{Z:()=>a,a:()=>o});var i=t(7294);const r={},s=i.createContext(r);function o(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);